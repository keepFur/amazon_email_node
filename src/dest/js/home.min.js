"use strict";function _defineProperty(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}layui.use(["element","layer","table","util"],function(){var a=layui.element,t=layui.layer,r=layui.table,n=layui.util,i=echarts.init(document.getElementById("taskCount")),o=echarts.init(document.getElementById("kbCount")),d=echarts.init(document.getElementById("taskType")),c=echarts.init(document.getElementById("kbType")),s=echarts.init(document.getElementById("addScore")),u="",m={title:{text:"流量购买量走势图"},tooltip:{},legend:{right:10,top:0,data:["流量购买量"]},xAxis:{data:[]},yAxis:{},series:[{name:"来了购买量",type:"line",data:[]}]},l={title:{text:"空包购买量走势图"},tooltip:{},legend:{right:10,top:0,data:["空包购买量"]},xAxis:{data:[]},yAxis:{},series:[{name:"空包购买量",type:"line",data:[]}]},y={title:{text:"流量购买类型分布图"},tooltip:{trigger:"item",formatter:"{a} <br/>{b} : {c} ({d}%)"},series:[{name:"流量类型",type:"pie",radius:"55%",center:["40%","50%"],data:[],itemStyle:{emphasis:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}}]},f={title:{text:"空包购买类型分布图",x:"right"},tooltip:{trigger:"item",formatter:"{a} <br/>{b} : {c} ({d}%)"},series:[{name:"空包类型",type:"pie",radius:"55%",center:["40%","50%"],data:[],itemStyle:{emphasis:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}}]},p={title:{text:"余额充值柱状图"},tooltip:{},legend:{right:10,top:0,data:["余额充值"]},xAxis:{data:[]},yAxis:{},series:[{name:"余额充值",type:"bar",data:[]}]};function h(e){var a=w(e=e||7),t=a[0],r=a[e-1];m.xAxis.data=a,$.get("/api/readTaskCountOfInTime",{createdDateStart:t,createdDateEnd:r},function(e){var t=e.data.rows;a.forEach(function(e){x(e,t)||t.push({createdDate:$.formatDate("yyyy/mm/dd",e),count:0})}),(t=t.map(function(e,t){return{createdDate:$.formatDate("yyyy/mm/dd",e.createdDate),count:e.count}})).sort(function(e,t){return new Date(e.createdDate).getTime()-new Date(t.createdDate).getTime()}),m.series[0].data=t.map(function(e,t){return e.count}),i.setOption(m)})}function g(e){var a=w(e=e||7),t=a[0],r=a[e-1];l.xAxis.data=a,$.get("/api/readKbCountOfInTime",{createdDateStart:t,createdDateEnd:r},function(e){var t=e.data.rows;a.forEach(function(e){x(e,t)||t.push({createdDate:$.formatDate("yyyy/mm/dd",e),count:0})}),(t=t.map(function(e,t){return{createdDate:$.formatDate("yyyy/mm/dd",e.createdDate),count:e.count}})).sort(function(e,t){return new Date(e.createdDate).getTime()-new Date(t.createdDate).getTime()}),l.series[0].data=t.map(function(e,t){return e.count}),o.setOption(l)})}function D(e){var t=w(e=e||7),a=t[0],r=t[e-1];$.get("/api/readTaskTypeOfInTime",{createdDateStart:a,createdDateEnd:r},function(e){var t=e.data.rows;y.series[0].data=t.map(function(e){return{name:e.taskTypeName,value:e.count}}),d.setOption(y)})}function v(e){var t=w(e=e||7),a=t[0],r=t[e-1];$.get("/api/readKbTypeOfInTime",{createdDateStart:a,createdDateEnd:r},function(e){var t=e.data.rows;f.series[0].data=t.map(function(e){return{name:core.getPlantByCode(e.plant)+"("+e.kbCompany+")",value:e.count}}),c.setOption(f)})}function b(e){var a=w(e=e||7),t=a[0],r=a[e-1];p.xAxis.data=a,$.get("/api/readAddMoneyOfInTime",{createdDateStart:t,createdDateEnd:r},function(e){var t=e.data.rows;a.forEach(function(e){x(e,t)||t.push({createdDate:$.formatDate("yyyy/mm/dd",e),count:0})}),(t=t.map(function(e,t){return{createdDate:$.formatDate("yyyy/mm/dd",e.createdDate),count:e.count}})).sort(function(e,t){return new Date(e.createdDate).getTime()-new Date(t.createdDate).getTime()}),p.series[0].data=t.map(function(e,t){return core.fenToYuan(e.count)}),s.setOption(p)})}function w(e){if(e=e||7,isNaN(e))return console.log(e),[];for(var t=(new Date).getTime()-24*e*60*60*1e3,a=[],r=0;r<e;r++)a[r]=$.formatDate("yyyy/mm/dd",new Date(t+864e5*(r+1)));return a}function x(t,e){var a=!1;return t&&e&&Array.isArray(e)&&e.forEach(function(e){if($.formatDate("yyyy/mm/dd",e.createdDate)===t)return!(a=!0)},this),a}function e(e){return core.copyToClipBoard("jsShareEffect"),t.msg("推广文案已成功复制到粘贴板，去推广吧"),!1}h(),g(),D(),v(),b(),core.getUserInfoById(function(e){$(".js-user-score").text(core.fenToYuan(e.data.rows[0].money))}),core.getUserInfoById(function(e){var t;e.data.rows[0].otherShareCode,u=e.data.rows[0].myShareCode,r.render((_defineProperty(t={elem:"#shareUserTable",url:"/api/readShareUserPage",page:!0,where:{myShareCode:u},cols:[[{field:"",title:"序号",width:60,templet:function(e){return e.LAY_INDEX}},{field:"userName",title:"用户名"},{field:"createdDate",title:"创建时间",templet:function(e){return n.toDateString(e.createdDate,"yyyy-MM-dd HH:mm")}}]],limits:[10,20,50,100]},"page",{theme:"#1E9FFF",layout:["prev","page","next","skip","count","limit"]}),_defineProperty(t,"request",{pageName:"offset"}),_defineProperty(t,"response",{statusCode:!0}),_defineProperty(t,"parseData",function(e){return{code:e.success,msg:e.msg,count:e.data.total,data:e.data.rows}}),t));var a=location.host+"/?otherShareCode="+e.data.rows[0].myShareCode;$("input[name=shareLink]").val(a),$("#jsShareEffect").val("亲爱的朋友，我正在使用易店科技优化店铺，效果很不错哦，你也可以试试。点击下方为你准备的专属链接"+a+"进行注册吧。注册就送2.5元。")}),$("#copyShareLink").on("click",e),$("#searchBtn").on("click",function(){var e;return e={userName:$("input[name=username]").val().trim(),page:{curr:1,limit:10}},r.reload("shareUserTable",{where:e}),!1}),$("#resetBtn").on("click",function(){return $("#shareUserSearchForm")[0].reset(),!1}),$(".js-home-toggle-date").on("click","a",function(e){var t=$(this).data("type"),a=$(this).data("day");switch($(this).parents(".js-home-toggle-date").find("a").removeClass("layui-btn-normal").addClass("layui-btn-primary"),$(this).addClass("layui-btn-normal").removeClass("layui-btn-primary"),t){case"count":h(a);break;case"kbCount":g(a);break;case"type":D(a),v(a);break;case"addmoney":b(a);break;default:h(a)}return!1}),$("#viewMoreNotice").click(function(e){return t.open({content:'<div  id="noticeContainer" style="min-height:500px;overflow-y:auto;"></div>',area:["450px"],title:"公告列表",btn:"关闭",scrollbar:!1,shadeClose:!0,success:function(e,t){$.ajax({url:"/api/readNoticePage",data:{limit:5,offset:1},dataType:"json",success:function(e){var t;t=e.data.rows,$.each(t,function(e,t){var a;$("#noticeContainer").append('<div class="layui-card">\n                        <div class="layui-card-header">标题：'+(a=t).noticeTitle+'</div>\n                        <div class="layui-card-body">内容：'+a.noticeContent+"</div>\n                    </div>")}),a.render("collapse")}})}}),!1})});