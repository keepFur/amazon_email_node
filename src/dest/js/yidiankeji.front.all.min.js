"use strict";var $=mdui.JQ;$(function(){var e,s=6,i=15;function n(e){return $(".js-user-login").hasClass("mdui-hidden")&&($(this).addClass("li-selected").siblings().removeClass("li-selected"),$(".js-content,.front-footer").hide(),$(".js-user-register").hide().addClass("mdui-hidden"),$(".js-user-login").show().removeClass("mdui-hidden")),!1}function t(e){var s=r($("form[name=userLoginForm]")),i=($(this),c(s));return i.isPass?$.ajax({url:"/api/userLogin",method:"POST",data:s,success:function(e,s,i){(e=JSON.parse(e)).success?(mdui.snackbar({message:"登录成功",position:"top"}),window.location.assign("/console")):mdui.snackbar({message:"登录失败:"+e.message,position:"top"})},error:function(e,s,i){mdui.snackbar({message:"网络错误",position:"top"})}}):mdui.snackbar({message:i.msg,position:"top"}),!1}function o(e){return $(".js-user-register").hasClass("mdui-hidden")&&($(this).addClass("li-selected").siblings().removeClass("li-selected"),$(".js-content,.front-footer").hide(),$(".js-user-login").hide().addClass("mdui-hidden"),$(".js-user-register").show().removeClass("mdui-hidden")),!1}function a(){var e=r($("form[name=userRegisterForm]")),s=c(e);$(this);return s.isPass?$.ajax({url:"/api/createUser",method:"POST",data:e,success:function(e,s,i){(e=JSON.parse(e)).success?(mdui.snackbar({message:"注册成功",position:"top"}),window.location.assign("/console")):mdui.snackbar({message:"注册失败:"+e.message,position:"top"})},error:function(e,s,i){mdui.snackbar({message:"网络错误，请刷新页面重试",position:"top"})}}):mdui.snackbar({message:s.msg,position:"top"}),!1}function r(e){var s={};return e&&e.length?(e.serializeArray().forEach(function(e){s[e.name]=$.trim(e.value)},this),s):($.writeLog("front-getUserInfo","参数错误"),{})}function c(e){return e?!e.userName||e.userName.length>i||e.userName.length<s?{isPass:!1,msg:"用户名是6-15位字母组成"}:!e.password||e.password.length>i||e.password.length<s?{isPass:!1,msg:"密码是6-15位字母组成"}:{isPass:!0,msg:"校验通过"}:($.writeLog("front-validUserInfo","参数错误"),{isPass:!1,msg:"参数错误"})}$.trim=function(e){return(e=e||"").replace(/^\s*|\s*$/g,"")},$.ajax({url:"/api/readNoticePage",data:{limit:5,offset:1},success:function(e){if((e=JSON.parse(e)).success){var t=$(".js-notice-container");0===e.data.rows.length?t.append('<a href="#">暂无公告</a>'):($.each(e.data.rows,function(e,s){var i=function(e,s){"string"!=typeof e&&(e="yyyy-mm-dd hh:MM:ss");var i,n=function(e){return"string"==typeof e},t=function(e){return 10<=e?e:"0"+e};return s={year:(i=n(i=s)?new Date(i):i||new Date).getFullYear(),month:i.getMonth()+1,day:i.getDate(),hours:i.getHours(),minutes:i.getMinutes(),seconds:i.getSeconds()},e.replace(/yyyy/gi,s.year).replace(/mm/,t(s.month)).replace(/dd/gi,t(s.day)).replace(/hh/gi,t(s.hours)).replace(/MM/,t(s.minutes)).replace(/ss/gi,t(s.seconds))}("yyyy-mm-dd HH:MM",s.createdDate),n='<a href="#" class="pull-left text-ellipsis js-notice-item '+(0===e?" js-notice-item-active":" hide")+'" data-id="'+s.id+'">\n                                        <span class="js-notice-title">'+i+"#"+s.noticeTitle+'</span>\n                                        <span class="js-notice-content">'+s.noticeContent+"</span>\n                                     </a>";t.append(n)}),setInterval(function(){var e=$(".js-notice-item"),s=e.length,i=$(".js-notice-item-active"),n=e.index(i[0]);n===s-1&&(n=-1),i.removeClass("js-notice-item-active").addClass("hide"),e.eq(n+1).addClass("js-notice-item-active").removeClass("hide")},1e4))}else t.append('<a href="#">暂无公告</a>')}}),e=null,$("#home").on("click",function(){return $(".js-user-login").hasClass("mdui-hidden")&&$(".js-user-register").hasClass("mdui-hidden")||window.location.reload(),!1}),$("#userRegister").on("click",o),$("#registerToLogin").on("click",function(){$("#userLogin").trigger("click")}),$("#userRegisterSubmit").on("click",a),$("#userLogin").on("click",n),$("#loginToRegister").on("click",function(){$("#userRegister").trigger("click")}),$("#userLoginSubmit").on("click",t),$("#console").on("click",function(e){return $.ajax({url:"/api/getUserLoginStatus",success:function(e){(e=JSON.parse(e)).status?window.location.assign("/console"):(mdui.snackbar({message:"请先登录系统",position:"top"}),$("#userLogin").trigger("click"))}}),!1}),$("#addMoney").on("click",function(e){$.ajax({url:"/api/getUserLoginStatus",success:function(e){(e=JSON.parse(e)).status?window.location.assign("/console#add_money"):(mdui.snackbar({message:"请先登录系统",position:"top"}),$("#userLogin").trigger("click"))}})}),$(".kefu-container").on("click",function(){return(e=new mdui.Dialog(".js-kefu-mdui-dialog")).open(),!1}),$(".kefu-btn-no").on("click",function(){return e.close(),!1}),$("#userLoginFooter,.buy").on("click",function(e){return $.ajax({url:"/api/getUserLoginStatus",success:function(e){(e=JSON.parse(e)).status?window.location.assign("/console#task_create"):(mdui.snackbar({message:"请先登录系统",position:"top"}),$("#userLogin").trigger("click"))}}),!1})});