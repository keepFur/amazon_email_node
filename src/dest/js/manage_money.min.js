"use strict";function _defineProperty(e,a,t){return a in e?Object.defineProperty(e,a,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[a]=t,e}layui.use(["table","element","layer","util","form"],function(){var e,i=layui.table,r=(layui.element,layui.layer),a=layui.util,t=layui.form,l={netErrMsg:"系统已退出登录，请登录系统重试",operatorErrMsg:{single:"请选择一条数据操作",batch:"请至少选择一条数据操作"}},n='<form class="layui-form layui-form-pane" name="packageCreateForm">\n                            <div class="layui-form-item">\n                                <label class="layui-form-label">名称</label>\n                                <div class="layui-input-block">\n                                    <input type="text" name="packageName" class="layui-input">\n                                </div>\n                            </div>\n                            <div class="layui-form-item">\n                                <label class="layui-form-label">购买积分</label>\n                                <div class="layui-input-block">\n                                    <input type="text" name="packagePurchaseScore" class="layui-input">\n                                </div>\n                            </div>\n                            <div class="layui-form-item">\n                                <label class="layui-form-label">赠送积分</label>\n                                <div class="layui-input-block">\n                                    <input type="text" name="packagePresentScore" class="layui-input">\n                                </div>\n                            </div>\n                            <div class="layui-form-item">\n                                <label class="layui-form-label">购买金额</label>\n                                <div class="layui-input-block">\n                                    <input type="text" name="packagePurchaseMoney" class="layui-input">\n                                </div>\n                            </div>\n                            <div class="layui-form-item">\n                                <label class="layui-form-label">赠送金额</label>\n                                <div class="layui-input-block">\n                                    <input type="text" name="packagePresentMoney" class="layui-input">\n                                </div>\n                            </div>\n                            <div class="layui-form-item">\n                                <label class="layui-form-label">支付方式</label>\n                                <div class="layui-input-block">\n                                    <input type="text" name="packagePayMethod" placeholder="0 是微信和支付宝，1 是微信，2 是支付宝，默认是0" class="layui-input">\n                                </div>\n                            </div>\n                        </form>';function s(e){var a,t;return p({where:(a=$("#logsSearchForm").serializeArray(),t={},$.each(a,function(e,a){t[a.name]=a.value}),t),page:{curr:1,limit:10}}),!1}function c(e){return r.open({content:n,area:["400px","450px"],title:"新增支付套餐",btn:["保存","取消"],yes:function(n,e){var a=core.getFormValues($("form[name=packageCreateForm]"));a.packagePayMethod=a.packagePayMethod||0;var t=m(a);t.isPass?$.ajax({url:"/api/createPackage",type:"POST",data:a,success:function(e,a,t){r.msg(e.success?"操作成功":"操作失败"),r.close(n),p()},error:function(e,a,t){r.msg(l.errorMsg)}}):r.msg(t.msg)}}),!1}function u(e){var s=i.checkStatus("packageTable").data;if(1===s.length){s[0].packageName,s[0].description;r.open({content:n,area:["400px","450px"],title:"充值套餐信息修改",btn:["确定","取消"],yes:function(n,e){var a=core.getFormValues($("form[name=packageCreateForm]")),t=m(a);a.id=s[0].id,t.isPass?$.ajax({url:"/api/updatePackage",type:"POST",data:a,success:function(e,a,t){r.msg(e.success?"操作成功":"操作失败"+e.message),r.close(n),p()},error:function(e,a,t){r.msg(l.errorMsg)}}):r.msg(t.msg)},success:function(){!function(e,a){for(var t in a=a||$("form[name=packageCreateForm]"),e)if(e.hasOwnProperty(t)){var n=e[t];a.find("input[name="+t+"]").val(n)}}(s[0])}})}else r.msg(l.operatorErrMsg.single);return!1}function o(e){var t=i.checkStatus("packageTable").data,n=e.data.type,a=0===n?"确定禁用吗？":"确定启用吗？";return 1===t.length?r.confirm(a,{title:"询问框",btn:["确定","取消"]},function(e,a){$.ajax({url:"/api/togglePackage",type:"POST",data:{id:t[0].id,status:n},success:function(e,a,t){r.msg(e.success?"操作成功":"操作失败"+e.message),p()},error:function(e,a,t){r.msg(l.netErrMsg)}})}):r.msg(l.operatorErrMsg.single),!1}function p(e){i.reload("packageTable",e)}function m(e){return e?e.packageName?e.packagePurchaseMoney?e.packagePresentMoney?e.packagePurchaseScore?e.packagePresentScore?{isPass:!0,msg:""}:{isPass:!1,msg:"充值套餐赠送积分不能为空"}:{isPass:!1,msg:"充值套餐购买积分不能为空"}:{isPass:!1,msg:"充值套餐赠送金额不能为空"}:{isPass:!1,msg:"充值套餐购买金额不能为空"}:{isPass:!1,msg:"充值套餐名称不能为空"}:{isPass:!1,msg:"参数错误"}}t.render("select"),i.render((_defineProperty(e={elem:"#packageTable",url:"/api/readPackagePage",page:!0,cols:[[{checkbox:!0},{title:"名称",field:"packageName"},{title:"充值积分（购买/赠送）",field:"",templet:function(e){return e.packagePurchaseScore+"/"+e.packagePresentScore}},{title:"金额（购买金额/赠送金额）",field:"packageMoney",templet:function(e){return e.packagePurchaseMoney+"/"+e.packagePresentMoney}},{title:"创建时间",field:"createdDate",templet:function(e){return a.toDateString(e.createdDate,"yyyy-MM-dd HH:mm")}},{title:"修改时间",field:"",styles:{width:130},templet:function(e){return e.updateDate?a.toDateString(e.updateDate,"yyyy-MM-dd HH:mm"):"-"}},{title:"状态",field:"status",styles:{width:56},templet:function(e){return 1===e.status?"启用":"停用"}}]],limits:[10,20,50,100]},"page",{theme:"#1E9FFF",layout:["prev","page","next","skip","count","limit"]}),_defineProperty(e,"request",{pageName:"offset"}),_defineProperty(e,"response",{statusCode:!0}),_defineProperty(e,"parseData",function(e){return{code:e.success,msg:e.msg,count:e.data.total,data:e.data.rows}}),_defineProperty(e,"done",function(e){var a,t;a=e.data.length,t=e.count,$("#currentPackageMountSpan").text(a),$("#packageMountSpan").text(t)}),e)),$("#searchBtn").on("click",s),$("#resetBtn").on("click",function(){return $("#logsSearchForm")[0].reset(),!1}),$("#createPackageBtn").on("click",c),$("#updatePackageBtn").on("click",u),$("#disabledPackageBtn").on("click",{type:0},o),$("#enabledPackagneBtn").on("click",{type:1},o)});